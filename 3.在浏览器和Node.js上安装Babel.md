## 3. 在浏览器和Node.js上安装Babel 

这个章节包含了Babel的代码翻译安装示例： 

- [客户端的ES6来自webpack和Babel](https://leanpub.com/setting-up-es6/read#sec_webpack-babel)（浏览器，webpack，静态代码翻译） 
- [动态代码翻译的ES6在Node.js上通过Babel](https://leanpub.com/setting-up-es6/read#sec_nodejs-babel-dynamic)（Node.js，Babel，动态代码翻译） 
- [静态的代码翻译的在Node.js上的ES6通过Babel](https://leanpub.com/setting-up-es6/read#sec_nodejs-babel-static)(Node.js，Babel，gulp，静态代码翻译) 

这些有帮助的安装件和Babel的配置大致类似。如果你没有安装，翻阅以下两个资源： 

- “[Configuring Babel 6](https://brickcarvingartist.github.io/Setting-up-ES6/4.%E9%85%8D%E7%BD%AEBabel6)”章节 
- [The Babel docs](http://babeljs.io/docs/setup/) 

有两个技术会被安装件用到，这是我为什么首先阐述它们的原因： 

- 通过npm安装本地模块 
- 用源码地图通过原始ES6来debug翻译代码 

### 3.1 npm和安装的本地模块 

npm可以帮助你下载一切你需要的东西去本地化管理一个项目。要看如何做到的，去看一下接下来的在被npm管理的包中的`package.json`文件： 

```json
{
	"dependencies": {
		···
	},
	"devDependencies": {
		"mocha": "^2.2.5",
		···
	},
	"bin": {
		"foo": "./bin/foo.js"
	},
	"scripts": {
		"foo": "./bin/foo.js",
		"test": "mocha --ui qunit --compilers"
	}
}
``` 

释义: 

- `dependencies`，`devDependencies`：当前包所用到的包。由`npm install`安装至`node_modules`。单元测试工具mocha是仅属于开发环境的依赖。 
- `bin`：在这里列出的都适用于shell命令行（当被全局安装后）以及被当前包当作依赖的脚本的包。 
- `scripts`：所有在这个对象里的入口都有两部分 - 定义脚本名的键，定义脚本如何运作的值。一个名为`foo`的脚本能被以`npm run foo`运行。 
 - 额外的被提供在`npm run foo`后的参数会传给这个脚本。 
 - `bin`中由包依赖提供的可执行文件能被用在脚本的定义中。这就是为什么`mocha`命令在这里适用，虽然没有任何东西被全局安装。唉可惜，当前`package.json`的`bin`的入口文件在这里不适用。 

一些脚本有缩写方式： 

- `npm test`和`npm t`是短版的`npm run test`。短版书写的有额外的好处就是不会展示出执行错误的报错信息（当一个mocha测试失败时即是如此）。 
- `npm start`是（大体上得）一个短版的`npm run start`。 

### 3.2 源码地图 

源码地图对任何被编译成JavaScript的编程语言都有帮助。将源码编译成源码也称之为代码翻译。代码翻译案例： 

- Minification（常规的JavaScript到被压缩的JavaScript） 
- CoffeeScript 
- ECMAScript 6（ES6到ES5） 

源码地图文件伴随着输出的代码翻译以及遍历出输出文件与输入文件的一行行对应关系。这个信息是提供给错误信息和debug行为的，用以参考被代码翻译的原始代码。有两种方式让工具明白源码地图：不是代码输出相关于在源码地图文件的最后一行，它就是插入到文件内容的最后一行。 

⚠️更多关于源码地图的信息 

获取更多源码地图的信息，前往资源列表看Ryan Seddon的“[Source maps: language, tools and other info](https://github.com/ryanseddon/source-map/wiki/Source-maps:-languages,-tools-and-other-info)” 

---

### 3.3 浏览器安装：通过webpack和Babel书写ES6 

这节介绍通过下面的技术的安装使客户端ES6可用： 

- [webpack](http://webpack.github.io/)作为客户端模块构建工具和模块加载器。
- [npm](https://www.npmjs.com/)作为包管理工具。 
- [Babel](http://babeljs.io/)作为由ES6至ES5的代码翻译器。（我们将用到Babel 6）。 

#### 3.3.1 webpack特点 

值得注意的webpack特点包括： 

- 支持模块化：AMD，CommonJS 
 - 通过加载器（插件）：ES6 
- 支持包管理工具：Bower，npm 
- 不需要编码的加载器：CSS，templates，... 
- 按需加载（数据块传输） 
- 内置支持浏览器自动刷新的开发服务器以及模块热重载（在开发中都很有用） 
- [去除死码](https://github.com/webpack/webpack/tree/master/examples/harmony-unused)（也人们称为tree shaking） 

#### 3.3.2 安装项目案例 

这一节检析一个项目案例。如果你想要，你可以下载它，像这样： 

- 下载或克隆Github上的[webpack-babel-demo](https://github.com/rauschma/webpack-babel-demo)仓库 
- `cd webpack-babel-demo/` 
- `npm install` 

一切都已经本地安装了。

## 支持译者继续翻译 

![支持译者继续翻译](http://static.ikindness.cn/donate.png)

---

首页：[架设ES6](https://brickcarvingartist.github.io/Setting-up-ES6) 

上一章：[使用ECMAScript6开发 ](https://brickcarvingartist.github.io/Setting-up-ES6/2.%E4%BD%BF%E7%94%A8ECMAScript6%E5%BC%80%E5%8F%91) 

下一章：[配置Babel6](https://brickcarvingartist.github.io/Setting-up-ES6/4.%E9%85%8D%E7%BD%AEBabel6)
